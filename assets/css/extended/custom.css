/* =============================================================================
   ENHANCED DEVOPS WAY BLOG - КИРИЛЛИЧЕСКАЯ ТИПОГРАФИКА
   ============================================================================= */

/* ========================================
   1. ШРИФТЫ И ТИПОГРАФИКА ДЛЯ КИРИЛЛИЦЫ
   ======================================== */

/* Основные шрифты с поддержкой кириллицы */
:root {
  --font-code: 'SF Mono', 'Cascadia Code', 'Fira Code', 'Roboto Mono', 'Courier New', monospace;
  --font-heading: 'PT Sans', 'Roboto', 'Source Serif Pro', 'Georgia', serif;
  --font-primary: 'PT Sans', 'Roboto', 'Noto Sans', 'Arial', sans-serif;
}

/* Базовая типографика */
body {
  font-family: var(--font-primary);
  font-size: clamp(16px, 2.5vw, 18px);
  line-height: 1.6;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Адаптивные заголовки */
h1, .post-title {
  font-family: var(--font-heading);
  font-size: clamp(32px, 5vw, 42px);
  font-weight: 700;
  line-height: 1.2;
  margin: 1.5rem 0 1rem 0;
  transition: color 0.3s ease;
}

h2 {
  font-family: var(--font-heading);
  font-size: clamp(28px, 4vw, 36px);
  font-weight: 600;
  line-height: 1.3;
  margin: 0.875rem 0 0.5rem 0;
  margin: 1.25rem 0 0.75rem 0;
  transition: color 0.3s ease;
}

h3 {
  font-family: var(--font-heading);
  font-size: clamp(24px, 3.5vw, 28px);
  font-weight: 600;
  line-height: 1.3;
  margin: 0.75rem 0 0.375rem 0;
  margin: 1rem 0 0.5rem 0;
  transition: color 0.3s ease;
}

h4, h5, h6 {
  font-family: var(--font-heading);
  font-size: clamp(18px, 3vw, 22px);
  font-weight: 600;
  line-height: 1.4;
  margin: 0.875rem 0 0.5rem 0;
  transition: color 0.3s ease;
}

/* ========================================
   2. ПЛАВНАЯ НАВИГАЦИЯ И ПЕРЕХОДЫ
   ======================================== */

html {
  scroll-behavior: smooth;
}

/* Плавные переходы для всех элементов */
*, *::before, *::after {
  transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
}

/* Переходы для интерактивных элементов */
a, button, .copy-code, .highlight {
  transition: all 0.3s ease;
}

/* ========================================
   3. АДАПТИВНЫЕ ТАБЛИЦЫ
   ======================================== */

.table-wrapper {
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  margin: 1.5rem 0;
  overflow-x: auto;
}

table {
  background: var(--entry);
  border-collapse: collapse;
  font-size: 14px;
  font-size: clamp(14px, 2vw, 16px);
  transition: background-color 0.3s ease;
  width: 100%;
}

table th,
table td {
  border-bottom: 1px solid var(--border);
  padding: 0.75rem 1rem;
  text-align: left;
  transition: background-color 0.3s ease;
}

table th {
  background: var(--theme);
  color: var(--primary);
  font-weight: 600;
}

table tr:hover {
  background: var(--code-bg);
}

/* Мобильная адаптация таблиц */
@media (max-width: 768px) {
  .table-wrapper {;
  margin: 1rem -1rem;
}

table th,
  table td {
  padding: 0.5rem 0.75rem;
}

}

/* ========================================
   4. УЛУЧШЕННАЯ ПОДСВЕТКА КОДА
   ======================================== */

/* Сохраняем существующую Hugo Paper Light тему */
.highlight.hugo-paper-light {
  background: #fafafa;
  border-radius: 8px;
  border: 1px solid #e1e5e9;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  font-family: var(--font-code);
  margin: 1.5rem 0;
  overflow: hidden;
  position: relative;
  transition: box-shadow 0.3s ease;
}

.highlight.hugo-paper-light:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
}

.highlight.hugo-paper-light pre {
  background: #fafafa;
  border-radius: 0;
  border: none;
  color: #24292f;
  font-size: clamp(14px, 2vw, 16px);
  font-weight: 400;
  line-height: 1.5;
  margin: 0;
  overflow-x: auto;
  padding: 1.25rem 1.5rem;
}

/* Автоматическое применение для светлой темы */
body:not(.dark) .highlight {
  background: #fafafa;
  border-radius: 8px;
  border: 1px solid #e1e5e9;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  transition: box-shadow 0.3s ease;
}

body:not(.dark) .highlight:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
}

/* ========================================
   5. УЛУЧШЕННАЯ КНОПКА КОПИРОВАНИЯ
   ======================================== */

.copy-code {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 6px;
  border: 1px solid #e1e5e9;
  color: #586069;
  cursor: pointer;
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.5rem 0.75rem;
  position: absolute;
  right: 0.75rem;
  top: 0.75rem;
  transition: all 0.3s ease;
  z-index: 10;
}

.copy-code:hover {
  background: #ffffff;
  border-color: #d0d7de;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
  color: #24292f;
  transform: translateY(-1px);
}

.copy-code.success {
  background: #28a745;
  border-color: #28a745;
  color: white;
}

.copy-code.error {
  background: #dc3545;
  border-color: #dc3545;
  color: white;
}

/* Темная тема для кнопки */
body.dark .copy-code {
  background: rgba(33, 38, 45, 0.95);
  border: 1px solid #30363d;
  color: #e6edf3;
}

body.dark .copy-code:hover {
  background: #21262d;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

/* ========================================
   6. ACCESSIBILITY И КОНТРАСТ
   ======================================== */

/* Минимальные размеры шрифтов */
@media (max-width: 480px) {
  body {;
  font-size: 16px; /* минимум для читаемости */;
}

.copy-code {
  font-size: 12px;
  padding: 0.375rem 0.5rem;
  right: 0.5rem;
  top: 0.5rem;
}

}

/* Улучшенная фокусировка */
a:focus,
button:focus,
.copy-code:focus {
  border-radius: 4px;
  outline-offset: 2px;
  outline: 2px solid var(--accent);
}

/* ========================================
   7. СПЕЦИАЛЬНЫЕ ЭЛЕМЕНТЫ DEVOPS
   ======================================== */

/* Стилизация блоков команд */
.highlight .nb,      /* встроенные команды (echo, cat, git) */
.highlight .nf,      /* функции */
.highlight .fm {
  color: #2563eb ;    /* синий цвет для команд */;
  font-weight: 600;
}

body.dark .highlight .nb,
body.dark .highlight .nf,
body.dark .highlight .fm {
  color: #79c0ff ;    /* голубой для команд в темной теме */;
  font-weight: 600;
}

/* Специальные блоки для DevOps контента */
.terminal-block {
  background: #1e1e1e;
  border-left: 4px solid #00ff00;
  border-radius: 8px;
  color: #00ff00;
  font-family: var(--font-code);
  margin: 1.5rem 0;
  padding: 1rem;
}

.warning-block {
  background: #fff3cd;
  border-left: 4px solid #ffc107;
  border-radius: 8px;
  color: #856404;
  margin: 1.5rem 0;
  padding: 1rem;
}

body.dark .warning-block {
  background: #2d2a1f;
  color: #f4d03f;
}

/* ========================================
   8. МОБИЛЬНАЯ ОПТИМИЗАЦИЯ
   ======================================== */

@media (max-width: 768px) {
  .highlight {;
  border-radius: 8px 8px 0 0;
  margin: 1rem -0.5rem;
}

.highlight pre {
  padding: 1rem;
}

/* Компактные заголовки на мобильных */
  h1, .post-title {
  margin: 1rem 0 0.75rem 0;
}

}

@media (max-width: 480px) {
  .highlight pre {;
  .mermaid {;
  body:not(.dark) .highlight pre {;
  font-size: 12px;
  font-size: 14px;
  min-height: 250px;
  padding: 0.875rem;
}

}

/* ========================================
   9. ПРОИЗВОДИТЕЛЬНОСТЬ
   ======================================== */

/* Оптимизация прокрутки */
.highlight pre {
  scrollbar-color: #d0d7de #fafafa;
  scrollbar-width: thin;
}

.highlight pre::-webkit-scrollbar {
  height: 8px;
}

.highlight pre::-webkit-scrollbar-track {
  background: #fafafa;
}

.highlight pre::-webkit-scrollbar-thumb {
  background: #d0d7de;
  border-radius: 4px;
}

.highlight pre::-webkit-scrollbar-thumb:hover {
  background: #bcc3ce;
}

/* Темная тема для скроллбара */
body.dark .highlight pre {
  scrollbar-color: #6a737d #21262d;
}

body.dark .highlight pre::-webkit-scrollbar-track {
  background: #21262d;
}

body.dark .highlight pre::-webkit-scrollbar-thumb {
  background: #6a737d;
}

/* ========================================
   10. ДОПОЛНИТЕЛЬНЫЕ УЛУЧШЕНИЯ
   ======================================== */

/* Улучшенные списки */
.post-content ul,
.post-content ol {
  margin: 1rem 0;
  padding-left: 1.5rem;
}

.post-content li {
  line-height: 1.6;
  margin: 0.25rem 0;
}

/* Улучшенные цитаты */
blockquote {
  border-left: 4px solid var(--accent);
  color: var(--secondary);
  font-style: italic;
  margin: 1.5rem 0;
  padding-left: 1.5rem;
  transition: border-color 0.3s ease, color 0.3s ease;
}

/* Встроенный код */
code:not([class]) {
  background: var(--code-bg);
  border-radius: 4px;
  color: var(--accent);
  font-family: var(--font-code);
  font-size: 0.875em;
  padding: 0.125rem 0.25rem;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Разделители */
hr {
  background: linear-gradient(90deg, transparent, var(--border), transparent);
  border: none;
  height: 1px;
  margin: 2rem 0;
}

/* ========================================
   11. ДОПОЛНИТЕЛЬНЫЕ СТИЛИ ДЛЯ ТЕМЫ
   ======================================== */

/* Существующие стили Hugo Paper остаются без изменений */
/* Сохраняем всю существующую функциональность подсветки синтаксиса */

/* Комментарии - приглушенный серый */
.highlight.hugo-paper-light .c,
.highlight.hugo-paper-light .c1,
.highlight.hugo-paper-light .cm,
.highlight.hugo-paper-light .cp {
  color: #6a737d;
  font-style: italic;
}

/* Строки - зеленый */
.highlight.hugo-paper-light .s,
.highlight.hugo-paper-light .s1,
.highlight.hugo-paper-light .s2,
.highlight.hugo-paper-light .se,
.highlight.hugo-paper-light .sa {
  color: #032f62;
}

/* Ключевые слова - красный */
.highlight.hugo-paper-light .k,
.highlight.hugo-paper-light .kd,
.highlight.hugo-paper-light .kn,
.highlight.hugo-paper-light .kt,
.highlight.hugo-paper-light .kc {
  color: #d73a49;
  font-weight: 600;
}

/* Функции - фиолетовый */
.highlight.hugo-paper-light .nf,
.highlight.hugo-paper-light .fm,
.highlight.hugo-paper-light .nb {
  color: #6f42c1;
  font-weight: 500;
}

/* Переменные - темно-синий */
.highlight.hugo-paper-light .n,
.highlight.hugo-paper-light .nv,
.highlight.hugo-paper-light .nc {
  color: #24292f;
}

/* Числа - синий */
.highlight.hugo-paper-light .m,
.highlight.hugo-paper-light .mi,
.highlight.hugo-paper-light .mf,
.highlight.hugo-paper-light .mo {
  color: #005cc5;
}

/* Операторы - красный */
.highlight.hugo-paper-light .o,
.highlight.hugo-paper-light .ow {
  color: #d73a49;
}

/* Символы - базовый цвет */
.highlight.hugo-paper-light .p {
  color: #24292f;
}

/* Теги HTML - темно-зеленый */
.highlight.hugo-paper-light .nt {
  color: #22863a;
  font-weight: 600;
}

/* Атрибуты HTML - синий */
.highlight.hugo-paper-light .na {
  color: #6f42c1;
}

/* =============================================================================
   ИСПРАВЛЕНИЕ СВЕТЛОЙ ТЕМЫ - УЛУЧШЕННАЯ КОНТРАСТНОСТЬ
   ============================================================================= */

/* Светлая тема - основные блоки кода */
body:not(.dark) .highlight {
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #dee2e6;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

body:not(.dark) .highlight pre {
  background: #f8f9fa;
  background: #faf8f4 ; /* Теплый бежевый */;
  border: none;
  color: #212529;
  color: #3d3a35 ; /* Теплый темный текст */;
  font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Fira Code', monospace;
  font-size: 13px;
  font-size: 14px;
  line-height: 1.5;
  line-height: 1.6;
  margin: 0;
  overflow-x: auto;
  padding: 1.25rem 1.5rem;
  padding: 1rem;
}

body:not(.dark) .highlight pre code {
  background: transparent;
  border: none;
  color: #212529;
  color: #3d3a35 ; /* Базовый цвет */;
  color: #3d3a35 ; /* Теплый темный текст */;
  font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Fira Code', 'Roboto Mono', monospace;
  padding: 0;
}

/* =============================================================================
   УЛУЧШЕННАЯ ПОДСВЕТКА СИНТАКСИСА ДЛЯ СВЕТЛОЙ ТЕМЫ
   ============================================================================= */

/* Комментарии - серый */
body:not(.dark) .highlight .c,
body:not(.dark) .highlight .c1,
body:not(.dark) .highlight .cm,
body:not(.dark) .highlight .cp,
body:not(.dark) .highlight .cs {
  color: #6c757d;
  font-style: italic;
}

/* Строки - зеленый */
body:not(.dark) .highlight .s,
body:not(.dark) .highlight .s1,
body:not(.dark) .highlight .s2,
body:not(.dark) .highlight .se,
body:not(.dark) .highlight .sa,
body:not(.dark) .highlight .sb,
body:not(.dark) .highlight .sc,
body:not(.dark) .highlight .sd,
body:not(.dark) .highlight .sh,
body:not(.dark) .highlight .si,
body:not(.dark) .highlight .sx {
  color: #198754;
  font-weight: 500;
}

/* Ключевые слова - синий */
body:not(.dark) .highlight .k,
body:not(.dark) .highlight .kd,
body:not(.dark) .highlight .kn,
body:not(.dark) .highlight .kt,
body:not(.dark) .highlight .kc,
body:not(.dark) .highlight .kp,
body:not(.dark) .highlight .kr {
  color: #0d6efd;
  font-weight: 600;
}

/* Команды и функции - темно-синий */
body:not(.dark) .highlight .nb,
body:not(.dark) .highlight .nf,
body:not(.dark) .highlight .fm,
body:not(.dark) .highlight .nl {
  color: #0a58ca;
  font-weight: 600;
}

/* Переменные и имена - темный */
body:not(.dark) .highlight .n,
body:not(.dark) .highlight .nv,
body:not(.dark) .highlight .nc,
body:not(.dark) .highlight .nd,
body:not(.dark) .highlight .ni,
body:not(.dark) .highlight .ne {
  color: #495057;
}

/* Числа - оранжевый */
body:not(.dark) .highlight .m,
body:not(.dark) .highlight .mi,
body:not(.dark) .highlight .mf,
body:not(.dark) .highlight .mo,
body:not(.dark) .highlight .mh {
  color: #fd7e14;
  font-weight: 500;
}

/* Операторы - красный */
body:not(.dark) .highlight .o,
body:not(.dark) .highlight .ow,
body:not(.dark) .highlight .p {
  color: #dc3545;
}

/* Теги HTML - темно-зеленый */
body:not(.dark) .highlight .nt {
  color: #20c997;
  font-weight: 600;
}

/* Атрибуты HTML - фиолетовый */
body:not(.dark) .highlight .na,
body:not(.dark) .highlight .nx {
  color: #6f42c1;
}

/* Специальные символы - серый */
body:not(.dark) .highlight .gi,
body:not(.dark) .highlight .gd,
body:not(.dark) .highlight .go,
body:not(.dark) .highlight .gp,
body:not(.dark) .highlight .gs,
body:not(.dark) .highlight .gu,
body:not(.dark) .highlight .gt {
  color: #6c757d;
}

/* =============================================================================
   УЛУЧШЕННАЯ КНОПКА КОПИРОВАНИЯ ДЛЯ СВЕТЛОЙ ТЕМЫ
   ============================================================================= */

body:not(.dark) .copy-code {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 6px;
  border: 1px solid #dee2e6;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  color: #495057;
  cursor: pointer;
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.375rem 0.75rem;
  position: absolute;
  right: 0.75rem;
  top: 0.75rem;
  transition: all 0.2s ease;
  z-index: 10;
}

body:not(.dark) .copy-code:hover {
  background: #ffffff;
  border-color: #adb5bd;
  border-color: #d4c4a8 ; /* Теплая граница при hover */;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  box-shadow: 0 4px 8px rgba(139, 117, 93, 0.2) ; /* Усиленная теплая тень */;
  color: #212529;
  color: #3d3a35 ; /* Теплый темный */;
  transform: translateY(-1px);
}

body:not(.dark) .copy-code.success {
  background: #198754;
  background: #2e7d32 ; /* Теплый зеленый */;
  border-color: #198754;
  border-color: #2e7d32;
  color: white;
}

body:not(.dark) .copy-code.error {
  background: #c62828 ; /* Теплый красный */;
  background: #dc3545;
  border-color: #c62828;
  border-color: #dc3545;
  color: white;
}

/* =============================================================================
   МОБИЛЬНАЯ АДАПТАЦИЯ ДЛЯ СВЕТЛОЙ ТЕМЫ
   ============================================================================= */

@media (max-width: 768px) {
  body:not(.dark) .highlight {;
  border-left: none;
  border-radius: 8px;
  border-right: none;
  margin: 1rem -0.5rem;
}

body:not(.dark) .copy-code {
  font-size: 0.65rem;
  font-size: 0.7rem;
  padding: 0.25rem 0.5rem;
  padding: 0.2rem 0.4rem;
  right: 0.5rem;
  top: 0.5rem;
}

}

/* =============================================================================
   УЛУЧШЕННЫЕ SCROLLBARS ДЛЯ СВЕТЛОЙ ТЕМЫ
   ============================================================================= */

body:not(.dark) .highlight pre {
  scrollbar-color: #dee2e6 #f8f9fa;
  scrollbar-width: thin;
}

body:not(.dark) .highlight pre::-webkit-scrollbar {
  background: #f8f9fa;
  background: #faf8f4 ; /* Теплый фон */;
  height: 8px;
}

body:not(.dark) .highlight pre::-webkit-scrollbar-track {
  background: #f8f9fa;
  background: #faf8f4 ; /* Теплый фон трека */;
  border-radius: 4px;
}

body:not(.dark) .highlight pre::-webkit-scrollbar-thumb {
  background: #dee2e6;
  background: #e8e4dc ; /* Теплый цвет ползунка */;
  border-radius: 4px;
}

body:not(.dark) .highlight pre::-webkit-scrollbar-thumb:hover {
  background: #adb5bd;
  background: #d4c4a8 ; /* Темнее при hover */;
}

/* =============================================================================
   ПОДСВЕТКА ВЫДЕЛЕННОГО ТЕКСТА В КОДЕ
   ============================================================================= */

body:not(.dark) .highlight pre::selection,
body:not(.dark) .highlight pre code::selection {
  background: rgba(13, 110, 253, 0.2);
  color: inherit;
}

/* =============================================================================
   ДОПОЛНИТЕЛЬНЫЕ УЛУЧШЕНИЯ ЧИТАЕМОСТИ
   ============================================================================= */

/* Встроенный код */
body:not(.dark) code:not([class]) {
  background: #e9ecef;
  border-radius: 4px;
  border: 1px solid #dee2e6;
  color: #495057;
  font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
  font-size: 0.875em;
  padding: 0.125rem 0.375rem;
}

/* Улучшение контраста для заголовков блоков */
body:not(.dark) .highlight .language-bash::before,
body:not(.dark) .highlight .language-shell::before {
  background: #6c757d;
  border-radius: 3px;
  color: white;
  content: "BASH";
  font-size: 0.7rem;
  font-weight: 600;
  left: 1rem;
  padding: 0.125rem 0.375rem;
  position: absolute;
  text-transform: uppercase;
  top: 0.5rem;
}

/* Специальные стили для разных языков */
body:not(.dark) .highlight[data-lang="yaml"] {
  border-left: 4px solid #6f42c1;
}

body:not(.dark) .highlight[data-lang="json"] {
  border-left: 4px solid #fd7e14;
}

body:not(.dark) .highlight[data-lang="bash"],
body:not(.dark) .highlight[data-lang="shell"] {
  border-left: 4px solid #198754;
}

body:not(.dark) .highlight[data-lang="docker"],
body:not(.dark) .highlight[data-lang="dockerfile"] {
  border-left: 4px solid #0d6efd;
}

/* =============================================================================
   ФИНАЛЬНЫЕ ИСПРАВЛЕНИЯ КОНТРАСТНОСТИ
   ============================================================================= */

/* Убеждаемся что все элементы достаточно контрастны */
body:not(.dark) .highlight .w {
  color: #495057 ; /* Пробелы */;
}

body:not(.dark) .highlight .err {
  background: rgba(220, 53, 69, 0.1);
  color: #dc3545 ; /* Ошибки */;
}

body:not(.dark) .highlight .x {
  color: #495057 ; /* Прочие токены */;
}

/* =============================================================================
   ТЕПЛАЯ СВЕТЛАЯ ТЕМА ДЛЯ КОМФОРТНОГО ЧТЕНИЯ
   ============================================================================= */

/* Теплый фон для всего сайта в светлой теме */
body:not(.dark) {
  background-color: #fefcf8 ; /* Теплый кремовый фон */;
  color: #2d2a26 ; /* Теплый темный текст */;
}

/* Теплый фон для контента */
body:not(.dark) .main,
body:not(.dark) .post,
body:not(.dark) .entry,
body:not(.dark) article {
  background-color: #fefcf8;
}

/* =============================================================================
   ТЕПЛЫЕ БЛОКИ КОДА С ИСПРАВЛЕНИЯМИ
   ============================================================================= */

/* Основной блок кода - теплый бежевый фон */
body:not(.dark) .highlight {
  background: #faf8f4 ; /* Теплый бежевый */;
  border-radius: 8px;
  border: 1px solid #e8e4dc ; /* Теплая граница */;
  box-shadow: 0 2px 8px rgba(139, 117, 93, 0.1) ; /* Теплая тень */;
  margin: 1.5rem 0;
  overflow: hidden;
  position: relative;
}

/* =============================================================================
   ИСПРАВЛЕНИЕ ДУБЛИРОВАНИЯ "BASH" - УБИРАЕМ ПСЕВДОЭЛЕМЕНТЫ
   ============================================================================= */

/* УБИРАЕМ автоматические метки языков */
body:not(.dark) .highlight .language-bash::before,
body:not(.dark) .highlight .language-shell::before,
body:not(.dark) .highlight[data-lang]::before {
  display: none ; /* Убираем дублирующие метки */;
}

/* =============================================================================
   ТЕПЛАЯ ЦВЕТОВАЯ СХЕМА ДЛЯ СИНТАКСИСА
   ============================================================================= */

/* Команды bash/shell - теплый синий */
body:not(.dark) .highlight .nb,
body:not(.dark) .highlight .nf,
body:not(.dark) .highlight .fm {
  color: #2c5aa0 ; /* Теплый синий */;
  font-weight: 600;
}

/* Строки - теплый зеленый */
body:not(.dark) .highlight .s,
body:not(.dark) .highlight .s1,
body:not(.dark) .highlight .s2,
body:not(.dark) .highlight .se,
body:not(.dark) .highlight .sa {
  color: #2d7d32 ; /* Теплый зеленый */;
  font-weight: 500;
}

/* Комментарии - теплый серый */
body:not(.dark) .highlight .c,
body:not(.dark) .highlight .c1,
body:not(.dark) .highlight .cm,
body:not(.dark) .highlight .cp {
  color: #8d7053 ; /* Теплый коричневато-серый */;
  font-style: italic;
}

/* Ключевые слова - теплый темно-синий */
body:not(.dark) .highlight .k,
body:not(.dark) .highlight .kd,
body:not(.dark) .highlight .kn,
body:not(.dark) .highlight .kt,
body:not(.dark) .highlight .kc {
  color: #1e4976 ; /* Теплый темно-синий */;
  font-weight: 600;
}

/* Числа - теплый оранжевый */
body:not(.dark) .highlight .m,
body:not(.dark) .highlight .mi,
body:not(.dark) .highlight .mf,
body:not(.dark) .highlight .mo {
  color: #e65100 ; /* Теплый оранжевый */;
  font-weight: 500;
}

/* Операторы - теплый красный */
body:not(.dark) .highlight .o,
body:not(.dark) .highlight .ow,
body:not(.dark) .highlight .p {
  color: #c62828 ; /* Теплый красный */;
}

/* Переменные - теплый темный */
body:not(.dark) .highlight .n,
body:not(.dark) .highlight .nv,
body:not(.dark) .highlight .nc {
  color: #4a453e ; /* Теплый темный */;
}

/* Теги HTML - теплый изумрудный */
body:not(.dark) .highlight .nt {
  color: #2e7d32 ; /* Теплый изумрудный */;
  font-weight: 600;
}

/* Атрибуты HTML - теплый фиолетовый */
body:not(.dark) .highlight .na {
  color: #6a1b9a ; /* Теплый фиолетовый */;
}

/* =============================================================================
   ТЕПЛАЯ КНОПКА КОПИРОВАНИЯ
   ============================================================================= */

body:not(.dark) .copy-code {
  background: rgba(254, 252, 248, 0.95) ; /* Теплый белый */;
  border-radius: 6px;
  border: 1px solid #e8e4dc ; /* Теплая граница */;
  box-shadow: 0 2px 4px rgba(139, 117, 93, 0.15) ; /* Теплая тень */;
  color: #5d4e37 ; /* Теплый коричневый */;
  cursor: pointer;
  font-size: 0.75rem;
  font-weight: 500;
  padding: 0.375rem 0.75rem;
  position: absolute;
  right: 0.75rem;
  top: 0.75rem;
  transition: all 0.2s ease;
  z-index: 10;
}

/* =============================================================================
   ТЕПЛЫЙ ВСТРОЕННЫЙ КОД
   ============================================================================= */

body:not(.dark) code:not([class]) {
  background: #f0ede6 ; /* Теплый бежевый */;
  border-radius: 4px;
  border: 1px solid #e8e4dc ; /* Теплая граница */;
  color: #5d4e37 ; /* Теплый коричневый */;
  font-family: 'SF Mono', 'Monaco', 'Cascadia Code', monospace;
  font-size: 0.875em;
  padding: 0.125rem 0.375rem;
}

/* =============================================================================
   ТЕПЛЫЕ ЦВЕТА ДЛЯ ЗАГОЛОВКОВ И ТЕКСТА
   ============================================================================= */

/* Заголовки - теплые оттенки */
body:not(.dark) h1,
body:not(.dark) h2,
body:not(.dark) h3,
body:not(.dark) h4,
body:not(.dark) h5,
body:not(.dark) h6,
body:not(.dark) .post-title {
  color: #3d3a35 ; /* Теплый темный */;
}

/* Ссылки - теплый синий */
body:not(.dark) a {
  color: #2c5aa0 ; /* Теплый синий */;
}

body:not(.dark) a:hover {
  color: #1e4976 ; /* Темнее при hover */;
}

/* =============================================================================
   ТЕПЛЫЕ SCROLLBARS
   ============================================================================= */

body:not(.dark) .highlight pre {
  scrollbar-color: #e8e4dc #faf8f4 ; /* Теплые цвета скроллбара */;
  scrollbar-width: thin;
}

/* =============================================================================
   ТЕПЛОЕ ВЫДЕЛЕНИЕ ТЕКСТА
   ============================================================================= */

body:not(.dark) .highlight pre::selection,
body:not(.dark) .highlight pre code::selection {
  background: rgba(44, 90, 160, 0.2) ; /* Теплое выделение */;
  color: inherit;
}

body:not(.dark) ::selection {
  background: rgba(44, 90, 160, 0.15) ; /* Теплое выделение для всего текста */;
  color: inherit;
}

/* =============================================================================
   ТЕПЛЫЕ ГРАНИЦЫ И РАЗДЕЛИТЕЛИ
   ============================================================================= */

body:not(.dark) hr {
  background: linear-gradient(90deg, transparent, #e8e4dc, transparent) ; /* Теплая граница */;
  border: none;
  height: 1px;
  margin: 2rem 0;
}

body:not(.dark) blockquote {
  background: rgba(250, 248, 244, 0.5) ; /* Теплый фон цитат */;
  border-left: 4px solid #d4c4a8 ; /* Теплая граница цитат */;
}

/* =============================================================================
   ТЕПЛАЯ НАВИГАЦИЯ И МЕНЮ
   ============================================================================= */

body:not(.dark) .header,
body:not(.dark) nav,
body:not(.dark) .menu {
  background-color: #fefcf8 ; /* Теплый фон навигации */;
  border-bottom: 1px solid #e8e4dc ; /* Теплая граница */;
}

/* =============================================================================
   АДАПТИВНОСТЬ С ТЕПЛЫМИ ЦВЕТАМИ
   ============================================================================= */

@media (max-width: 768px) {
  body:not(.dark) .highlight {;
  border-left: none;
  border-right: none;
  margin: 1rem -0.5rem;
}

}

/* =============================================================================
   ДОПОЛНИТЕЛЬНЫЕ ТЕПЛЫЕ УЛУЧШЕНИЯ
   ============================================================================= */

/* Теплые цвета для таблиц */
body:not(.dark) table {
  background: #fefcf8;
  border: 1px solid #e8e4dc;
}

body:not(.dark) table th {
  background: #f0ede6 ; /* Теплый заголовок таблицы */;
  color: #3d3a35;
}

body:not(.dark) table td {
  border-bottom: 1px solid #e8e4dc ; /* Теплые границы ячеек */;
}

body:not(.dark) table tr:hover {
  background: #f5f2ea ; /* Теплый hover для строк */;
}

/* Теплые кнопки и элементы управления */
body:not(.dark) button,
body:not(.dark) .button {
  background: #f0ede6;
  border: 1px solid #e8e4dc;
  color: #3d3a35;
}

body:not(.dark) button:hover,
body:not(.dark) .button:hover {
  background: #e8e4dc;
  color: #2d2a26;
}

/* =============================================================================
   ПРИНУДИТЕЛЬНОЕ ИСПРАВЛЕНИЕ BASH ПОДСВЕТКИ
   ============================================================================= */

/* ВАЖНО: Этот код должен идти ПОСЛЕ всех других правил */

/* =============================================================================
   БАЗОВЫЙ СБРОС ДЛЯ BASH БЛОКОВ
   ============================================================================= */

/* Сброс всех цветов в bash блоках на обычный */
body:not(.dark) .highlight[data-lang="bash"] span,
body:not(.dark) .highlight[data-lang="shell"] span,
body:not(.dark) .highlight.language-bash span,
body:not(.dark) .highlight.language-shell span {
  color: #3d3a35 ; /* Базовый теплый темный цвет */;
  font-weight: normal;
}

/* =============================================================================
   ТОЧЕЧНОЕ ПРИМЕНЕНИЕ ЦВЕТОВ
   ============================================================================= */

/* КОМАНДЫ - только встроенные команды bash */
body:not(.dark) .highlight[data-lang="bash"] .nb,
body:not(.dark) .highlight[data-lang="shell"] .nb,
body:not(.dark) .highlight.language-bash .nb,
body:not(.dark) .highlight.language-shell .nb {
  color: #2c5aa0 ; /* Синий для команд */;
  font-weight: 600;
}

/* СТРОКИ В КАВЫЧКАХ - только те что реально в кавычках */
body:not(.dark) .highlight[data-lang="bash"] .s1,
body:not(.dark) .highlight[data-lang="bash"] .s2,
body:not(.dark) .highlight.language-bash .s1,
body:not(.dark) .highlight.language-bash .s2 {
  color: #2d7d32 ; /* Зеленый только для строк в кавычках */;
  font-weight: 500;
}

/* КОММЕНТАРИИ */
body:not(.dark) .highlight[data-lang="bash"] .c,
body:not(.dark) .highlight[data-lang="bash"] .c1,
body:not(.dark) .highlight.language-bash .c,
body:not(.dark) .highlight.language-bash .c1 {
  color: #8d7053 ; /* Коричневый для комментариев */;
  font-style: italic;
}

/* ПЕРЕМЕННЫЕ $var */
body:not(.dark) .highlight[data-lang="bash"] .nv,
body:not(.dark) .highlight.language-bash .nv {
  color: #1e4976 ; /* Темно-синий для переменных */;
  font-weight: 500;
}

/* КЛЮЧЕВЫЕ СЛОВА (if, then, for, do) */
body:not(.dark) .highlight[data-lang="bash"] .k,
body:not(.dark) .highlight[data-lang="bash"] .kd,
body:not(.dark) .highlight.language-bash .k,
body:not(.dark) .highlight.language-bash .kd {
  color: #1e4976 ; /* Темно-синий для ключевых слов */;
  font-weight: 600;
}

/* ЧИСЛА */
body:not(.dark) .highlight[data-lang="bash"] .m,
body:not(.dark) .highlight[data-lang="bash"] .mi,
body:not(.dark) .highlight.language-bash .m,
body:not(.dark) .highlight.language-bash .mi {
  color: #e65100 ; /* Оранжевый для чисел */;
  font-weight: 500;
}

/* =============================================================================
   УБИРАЕМ ЗЕЛЕНЫЙ С ОБЫЧНОГО ТЕКСТА
   ============================================================================= */

/* Принудительно убираем зеленый с класса .s если он не s1 или s2 */
body:not(.dark) .highlight[data-lang="bash"] .s:not(.s1):not(.s2),
body:not(.dark) .highlight.language-bash .s:not(.s1):not(.s2) {
  color: #3d3a35 ; /* Обычный цвет */;
  font-weight: normal;
}

/* Убираем зеленый с обычных имен */
body:not(.dark) .highlight[data-lang="bash"] .n,
body:not(.dark) .highlight.language-bash .n {
  color: #3d3a35 ; /* Обычный цвет */;
  font-weight: normal;
}

/* Убираем зеленый с пунктуации */
body:not(.dark) .highlight[data-lang="bash"] .p,
body:not(.dark) .highlight.language-bash .p {
  color: #3d3a35 ; /* Обычный цвет */;
  font-weight: normal;
}

/* =============================================================================
   СПЕЦИАЛЬНОЕ ИСПРАВЛЕНИЕ ДЛЯ ECHO
   ============================================================================= */

/* После команды echo - все аргументы обычным цветом */
body:not(.dark) .highlight .nb:contains("echo") ~ span:not(.s1):not(.s2) {
  color: #3d3a35;
}

/* Или через более точный селектор */
body:not(.dark) .highlight span.nb + span.s {
  color: #3d3a35 ; /* НЕ зеленый для аргументов команд */;
}

/* Но если это строка в кавычках - тогда зеленый */
body:not(.dark) .highlight span.nb + span.s1,
body:not(.dark) .highlight span.nb + span.s2 {
  color: #2d7d32 ; /* Зеленый для строк в кавычках */;
}

/* =============================================================================
   FALLBACK - ПОСЛЕДНЯЯ ЛИНИЯ ОБОРОНЫ
   ============================================================================= */

/* Если все остальное не сработало - принудительно сбрасываем */
body:not(.dark) .highlight pre code * {
  color: inherit;
}

/* И заново применяем нужные цвета */
body:not(.dark) .highlight pre code .nb {
  color: #2c5aa0 ; font-weight: 600;
}

body:not(.dark) .highlight pre code .s1 {
  color: #2d7d32 ; font-weight: 500;
}

body:not(.dark) .highlight pre code .s2 {
  color: #2d7d32 ; font-weight: 500;
}

body:not(.dark) .highlight pre code .c {
  color: #8d7053 ; font-style: italic;
}

body:not(.dark) .highlight pre code .c1 {
  color: #8d7053 ; font-style: italic;
}

body:not(.dark) .highlight pre code .nv {
  color: #1e4976 ; font-weight: 500;
}

body:not(.dark) .highlight pre code .k {
  color: #1e4976 ; font-weight: 600;
}

body:not(.dark) .highlight pre code .m {
  color: #e65100 ; font-weight: 500;
}

body:not(.dark) .highlight pre code .mi {
  color: #e65100 ; font-weight: 500;
}

/* =============================================================================
   ИСПРАВЛЕНИЕ ДИАГРАММ MERMAID - СТАБИЛЬНОСТЬ И РАЗМЕРЫ
   ============================================================================= */

/* =============================================================================
   БАЗОВЫЕ ИСПРАВЛЕНИЯ КОНТЕЙНЕРА
   ============================================================================= */

   .mermaid {
  backface-visibility: hidden;
  background: transparent;
  font-family: 'PT Sans', 'Roboto', sans-serif;
  margin: 2rem 0;
  max-width: 100%;
  min-height: 400px;
  perspective: 1000px;
  text-align: center;
  transform: translateZ(0) ; /* Включаем GPU acceleration */;
  width: 100%;
}

/* =============================================================================
     ИСПРАВЛЕНИЯ SVG ЭЛЕМЕНТОВ
     ============================================================================= */
  
  .mermaid svg {
  border-radius: 8px;
  height: auto;
  max-width: 100%;
  min-height: 350px;
  shape-rendering: geometricPrecision;
  text-rendering: geometricPrecision;
  transform: translateZ(0);
  transition: none ; /* Убираем все transition эффекты */;
}

/* =============================================================================
     ИСПРАВЛЕНИЯ ДЛЯ КОНТЕЙНЕРА В КОНТЕНТЕ
     ============================================================================= */
  
  .post-content .mermaid {
  background: var(--entry);
  border-radius: 12px;
  border: 1px solid var(--border);
  min-height: 450px;
  overflow: visible ; /* Изменено с auto на visible */;
  padding: 2rem ; /* Увеличен padding */;
  transition: none;
}

/* Убираем hover эффекты полностью */
  .post-content .mermaid:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  transform: none ; /* Никаких трансформаций при hover */;
}

/* =============================================================================
     ИСПРАВЛЕНИЯ ЭЛЕМЕНТОВ ДИАГРАММЫ
     ============================================================================= */
  
  /* Узлы диаграммы - убираем hover дрожание */
  .mermaid .node,
  .mermaid .nodeLabel,
  .mermaid .cluster,
  .mermaid .edgePath,
  .mermaid .edgeLabel {
  transform: translateZ(0);
  transition: none;
}

/* Текст в узлах - стабилизация */
  .mermaid text {
  fill: currentColor;
  font-family: 'PT Sans', 'Roboto', sans-serif;
  font-size: 14px;
  shape-rendering: geometricPrecision;
  text-rendering: geometricPrecision;
  transition: none;
}

/* Прямоугольники и фигуры */
  .mermaid rect,
  .mermaid circle,
  .mermaid ellipse,
  .mermaid polygon {
  transform: translateZ(0);
  transition: none;
}

/* Линии и стрелки */
  .mermaid path,
  .mermaid line {
  shape-rendering: geometricPrecision;
  stroke-width: 2px;
  transition: none;
}

/* =============================================================================
     АДАПТИВНОСТЬ БЕЗ ДРОЖАНИЯ
     ============================================================================= */
  
  @media (max-width: 768px) {
  .mermaid {;
  font-size: 12px;
  margin: 1.5rem -1rem;
  min-height: 300px;
  padding: 1rem;
}

.mermaid svg {
  background: transparent;
  display: block;
  height: auto;
  margin: 0 auto;
  max-height: 500px;
  max-width: 100%;
  max-width: calc(100vw - 2rem);
  min-height: 200px;
  min-height: 250px;
  overflow: visible;
  width: auto;
}

.post-content .mermaid {
  min-height: 300px;
  min-height: 350px;
  padding: 1.5rem;
  padding: 1rem;
}

/* Уменьшаем размеры текста на мобильных */
    .mermaid text {
  font-size: 12px;
}

}
  
  @media (max-width: 480px) {
  .mermaid {;
  font-size: 11px;
  margin: 1rem -0.5rem;
  min-height: 250px;
  padding: 0.75rem;
}

.mermaid text {
  font-size: 10px;
}

}
  
  /* =============================================================================
     ТЕМАТИЧЕСКИЕ ИСПРАВЛЕНИЯ
     ============================================================================= */
  
  /* Светлая тема */
  body:not(.dark) .mermaid {
  background: #fefcf8 ; /* Теплый фон */;
}

body:not(.dark) .mermaid svg {
  filter: none ; /* Убираем фильтры */;
}

/* Темная тема */
  body.dark .mermaid {
  background: var(--entry);
}

body.dark .mermaid svg {
  filter: none ; /* Убираем фильтры */;
}

/* =============================================================================
     ДОПОЛНИТЕЛЬНЫЕ СТАБИЛИЗАЦИИ
     ============================================================================= */
  
  /* Предотвращаем скачки при загрузке */
  .mermaid[data-processed] {
  opacity: 1;
  visibility: visible;
}

.mermaid:not([data-processed]) {
  min-height: 400px;
  opacity: 0.5;
}

/* Скрываем элементы во время рендеринга */
  .mermaid .mermaid-loading {
  display: none;
}

/* =============================================================================
     ПРИНУДИТЕЛЬНЫЕ ИСПРАВЛЕНИЯ ДЛЯ ДРОЖАНИЯ
     ============================================================================= */
  
  /* Отключаем ВСЕ transitions и animations для Mermaid */
  .mermaid *,
  .mermaid *::before,
  .mermaid *::after {
  animation: none;
  transform: translateZ(0);
  transition: none;
}

/* Стабилизация всех hover эффектов */
  .mermaid *:hover {
  animation: none;
  transform: translateZ(0);
  transition: none;
}

/* =============================================================================
     ИСПРАВЛЕНИЯ ДЛЯ КОНКРЕТНЫХ ТИПОВ ДИАГРАММ
     ============================================================================= */
  
  /* Flowchart диаграммы */
  .mermaid .flowchart {
  height: auto;
  width: 100%;
}

/* Sequence диаграммы */
  .mermaid .sequence {
  overflow-x: auto;
  width: 100%;
}

/* Gantt диаграммы */
  .mermaid .gantt {
  overflow-x: auto;
  width: 100%;
}

/* Graph диаграммы */
  .mermaid .graph {
  height: auto;
  width: 100%;
}

/* =============================================================================
     ДОПОЛНИТЕЛЬНАЯ СТАБИЛИЗАЦИЯ РЕНДЕРИНГА
     ============================================================================= */
  
  /* Принудительная стабилизация для WebKit */
  .mermaid {
  -webkit-backface-visibility: hidden;
  -webkit-perspective: 1000px;
  -webkit-transform: translateZ(0);
}

/* Принудительная стабилизация для Firefox */
  .mermaid {
  -moz-backface-visibility: hidden;
  -moz-transform: translateZ(0);
}

/* Принудительная стабилизация для всех браузеров */
  .mermaid {
  contain: layout style paint ; /* CSS containment для производительности */;
  will-change: auto ; /* Отключаем will-change */;
}

/* =============================================================================
   ПРЕДОТВРАЩЕНИЕ ОШИБОК MERMAID ПРИ ПЕРЕКЛЮЧЕНИИ ТЕМ
   ============================================================================= */

/* =============================================================================
   СТАБИЛИЗАЦИЯ КОНТЕЙНЕРА ВО ВРЕМЯ ПЕРЕХОДОВ
   ============================================================================= */

.mermaid {
  contain: layout style paint;
  min-height: 400px;
  position: relative;
  transform: translateZ(0);
  transition: opacity 0.3s ease;
  width: 100%;
}

/* Состояние загрузки */
.mermaid:not([data-processed]) {
  &::before {;
  );
  45deg,;
  background: repeating-linear-gradient(;
  color: var(--secondary);
  content: "⏳ Загрузка диаграммы...";
  font-size: 14px;
  left: 50%;
  opacity: 0.7;
  position: absolute;
  rgba(0,0,0,0.03) 16px;
  rgba(0,0,0,0.03) 8px,;
  top: 50%;
  transform: translate(-50%, -50%);
  transparent 8px,;
  transparent,;
  z-index: 1;
}

}

/* Готовая диаграмма */
.mermaid[data-processed] {
  &::before {;
  background: none;
  display: none;
  opacity: 1;
}

}

/* =============================================================================
   ПРЕДОТВРАЩЕНИЕ КОНФЛИКТОВ CSS
   ============================================================================= */

/* Убираем конфликтующие стили во время рендеринга */
.mermaid[data-processing] {
  pointer-events: none;
  user-select: none;
}

/* SVG стабилизация */
.mermaid svg {
  height: auto;
  max-width: 100%;
  shape-rendering: geometricPrecision;
  text-rendering: optimizeLegibility;
  transform: translateZ(0);
  transition: none;
}

/* =============================================================================
   ИСПРАВЛЕНИЯ ДЛЯ РАЗНЫХ ТЕМ
   ============================================================================= */

/* Светлая тема */
body:not(.dark) .mermaid {
  background-color: transparent;
}

body:not(.dark) .mermaid[data-processed] {
  background: var(--entry, #fefcf8);
}

/* Темная тема */
body.dark .mermaid {
  background-color: transparent;
}

body.dark .mermaid[data-processed] {
  background: var(--entry, #1a1a1a);
}

/* =============================================================================
   УЛУЧШЕННЫЕ ОШИБКИ
   ============================================================================= */

.mermaid .mermaid-error {
  background: linear-gradient(135deg, #fff5f5, #fed7d7);
  border-radius: 12px;
  border: 2px dashed #fc8181;
  box-shadow: 0 4px 12px rgba(220, 53, 69, 0.15);
  color: #c53030;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  margin: 1rem 0;
  padding: 2rem;
}

.mermaid .mermaid-error h4 {
  color: #c53030;
  font-size: 1.1rem;
  font-size: 1.2rem;
  font-size: 1rem;
  margin: 0 0 1rem 0;
}

.mermaid .mermaid-error p {
  line-height: 1.5;
  margin: 0.5rem 0;
}

.mermaid .mermaid-error details {
  background: rgba(255, 255, 255, 0.8);
  border-radius: 8px;
  border: 1px solid #fc8181;
  margin-top: 1rem;
  padding: 1rem;
}

.mermaid .mermaid-error summary {
  background: rgba(252, 129, 129, 0.1);
  border-radius: 4px;
  cursor: pointer;
  font-weight: 600;
  padding: 0.5rem;
  transition: background-color 0.2s ease;
}

.mermaid .mermaid-error summary:hover {
  background: rgba(252, 129, 129, 0.2);
}

.mermaid .mermaid-error pre {
  background: #f7fafc;
  border-radius: 6px;
  border: 1px solid #e2e8f0;
  color: #2d3748;
  font-size: 0.75rem;
  font-size: 0.875rem;
  font-size: 0.8rem;
  line-height: 1.4;
  margin: 0.5rem 0 0 0;
  overflow-x: auto;
  padding: 0.75rem;
  padding: 1rem;
}

/* Темная тема для ошибок */
body.dark .mermaid .mermaid-error {
  background: linear-gradient(135deg, #2d1b1b, #3c1f1f);
  border-color: #fc8181;
  color: #fed7d7;
}

body.dark .mermaid .mermaid-error h4 {
  color: #fed7d7;
}

body.dark .mermaid .mermaid-error details {
  background: rgba(0, 0, 0, 0.3);
  border-color: #fc8181;
}

body.dark .mermaid .mermaid-error pre {
  background: #1a202c;
  border-color: #4a5568;
  color: #e2e8f0;
}

/* =============================================================================
   МОБИЛЬНАЯ АДАПТАЦИЯ
   ============================================================================= */

@media (max-width: 768px) {
  .mermaid {;
  margin: 1rem -0.5rem;
  min-height: 300px;
}

.mermaid .mermaid-error {
  border-radius: 0;
  margin: 1rem -0.5rem;
  padding: 1.5rem;
  padding: 1rem;
}

}
/* =============================================================================
   ПРИНУДИТЕЛЬНОЕ ИСПРАВЛЕНИЕ MERMAID SVG РЕНДЕРИНГА
   ============================================================================= */

   .mermaid {
  align-items: center;
  background: var(--entry);
  border-radius: 12px;
  border: 1px solid var(--border);
  display: flex;
  justify-content: center;
  margin: 2rem 0;
  min-height: 400px;
  padding: 2rem;
}

/* Принудительно показываем все узлы */
  /* НЕ ДЕЛАТЬ ЭТО — ломает встроенные fill/stroke 
  .mermaid .node rect,
  .mermaid .node circle,
  .mermaid .node ellipse,
  .mermaid .node polygon {
  fill: inherit;
  opacity: 1;
  stroke-width: 2px;
  stroke: inherit;
  visibility: visible;
}

*/
  
  /* Принудительно показываем весь текст */
  .mermaid .nodeLabel,
  .mermaid .node text {
  fill: #000;
  font-family: 'PT Sans', Arial, sans-serif;
  font-size: 14px;
  opacity: 1;
  visibility: visible;
}

/* Принудительно показываем все линии */
  .mermaid .edgePath path {
  fill: none;
  opacity: 1;
  stroke-width: 2px;
  stroke: #333;
  visibility: visible;
}

/* Стрелки */
  .mermaid .arrowheadPath {
  fill: #333;
  opacity: 1;
  visibility: visible;
}

/* Темная тема */
  body.dark .mermaid .nodeLabel,
  body.dark .mermaid .node text {
  fill: #fff;
}

body.dark .mermaid .edgePath path,
  body.dark .mermaid .arrowheadPath {
  fill: #fff;
  stroke: #fff;
}

/* =============================================================================
   ПРИНУДИТЕЛЬНОЕ ИСПРАВЛЕНИЕ MERMAID SVG ЭЛЕМЕНТОВ
   ============================================================================= */

/* Принудительно показываем ВСЕ элементы Mermaid */
.mermaid * {
  display: initial;
  opacity: 1;
  visibility: visible;
}

/* Узлы диаграммы - принудительные цвета */
.mermaid .node rect {
  fill: #bbdefb;
  stroke-width: 2px;
  stroke: #1976d2;
}

.mermaid .node:nth-child(2) rect {
  fill: #c8e6c9;
  stroke: #388e3c;
}

.mermaid .node:nth-child(3) rect {
  fill: #ffcdd2;
  stroke: #d32f2f;
}

.mermaid .node:nth-child(4) rect {
  fill: #f8bbd9;
  stroke: #c2185b;
}

.mermaid .node:nth-child(5) rect {
  fill: #d1c4e9;
  stroke: #7b1fa2;
}

.mermaid .node:nth-child(6) rect {
  fill: #ffecb3;
  stroke: #f57c00;
}

/* Текст в узлах */
.mermaid .nodeLabel,
.mermaid .node text {
  fill: #000;
  font-family: 'PT Sans', Arial, sans-serif;
  font-size: 14px;
  font-weight: 600;
  text-anchor: middle;
}

/* Линии и стрелки */
.mermaid .edgePath path {
  fill: none;
  stroke-width: 2px;
  stroke: #333;
}

.mermaid .arrowheadPath {
  fill: #333;
  fill: #333333;
  opacity: 1;
  stroke: #333;
  visibility: visible;
}

/* Пунктирные линии */
.mermaid .edge-pattern-dotted path {
  stroke-dasharray: 5,5;
}

/* Темная тема */
body.dark .mermaid .nodeLabel,
body.dark .mermaid .node text {
  fill: #fff;
}

body.dark .mermaid .edgePath path,
body.dark .mermaid .arrowheadPath {
  fill: #fff;
  stroke: #fff;
}

/* Дополнительная принудительная видимость */
.mermaid g {
  display: block;
  visibility: visible;
}

/* =============================================================================
   FIX: Восстановление цветов узлов Mermaid
   ============================================================================= */

   .mermaid .node rect,
   .mermaid .node circle,
   .mermaid .node ellipse,
   .mermaid .node polygon {
  fill: #bbdefb ;       /* Светло-синий фон узлов */;
  opacity: 1;
  stroke-width: 2px;
  stroke: #1976d2 ;     /* Синий бордер */;
  visibility: visible;
}

.mermaid .nodeLabel,
   .mermaid .node text,
   .mermaid text {
  fill: #000000 ;       /* Чёрный текст */;
  font-family: 'PT Sans', 'Roboto', Arial, sans-serif;
  font-size: 14px;
  opacity: 1;
  visibility: visible;
}

.mermaid .edgePath path {
  fill: none;
  opacity: 1;
  stroke-width: 2px;
  stroke: #333333 ;     /* Тёмно-серые стрелки */;
  visibility: visible;
}
.mermaid {
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 200px;
  overflow-x: auto;
  overflow-y: hidden;
  padding: 1rem;
}

.mermaid svg {
  display: block;
  height: auto;
  max-width: 100%;
  margin: 0 auto;
}
