/* =============================================================================
   ФИНАЛЬНОЕ ИСПРАВЛЕНИЕ ДЛЯ BODY.DARK + НОМЕРА СТРОК
   ============================================================================= */

/* =============================================================================
   СВЕТЛАЯ ТЕМА (по умолчанию)
   ============================================================================= */

.highlight {
  background: #ffffff !important;
  border: 1px solid #e2e8f0 !important;
  border-radius: 8px !important;
  margin: 1.5rem 0 !important;
  overflow: hidden !important;
  position: relative !important;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
}

.highlight pre {
  background: #ffffff !important;
  color: #0f172a !important;
  border: none !important;
  border-radius: 0 !important;
  padding: 1rem 1.25rem !important;
  overflow-x: auto !important;
  margin: 0 !important;
  line-height: 1.6 !important;
  font-size: 0.875rem !important;
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Cascadia Code', 'Courier New', monospace !important;
  font-weight: 400 !important;
}

.highlight pre code {
  background: transparent !important;
  color: #0f172a !important;
  border: none !important;
  padding: 0 !important;
  font-size: inherit !important;
  font-family: inherit !important;
  white-space: pre !important;
  font-weight: inherit !important;
}

/* =============================================================================
   ТЕМНАЯ ТЕМА - BODY.DARK
   ============================================================================= */

body.dark .highlight {
  background: #161b22 !important;
  border: 1px solid #30363d !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

body.dark .highlight pre {
  background: #161b22 !important;
  color: #e6edf3 !important;
}

body.dark .highlight pre code {
  background: transparent !important;
  color: #e6edf3 !important;
}

/* =============================================================================
   НОМЕРА СТРОК - МАКСИМАЛЬНОЕ СКРЫТИЕ
   ============================================================================= */

/* Полностью скрываем номера строк */
.highlight .lnt,
.highlight .lnl,
.lnt,
.lnl,
span.lnt,
span.lnl,
td.lnt,
td.lnl,
.highlight table .lnt,
.highlight table .lnl {
  position: fixed !important;
  top: -9999px !important;
  left: -9999px !important;
  width: 0 !important;
  height: 0 !important;
  opacity: 0 !important;
  visibility: hidden !important;
  display: none !important;
  user-select: none !important;
  -webkit-user-select: none !important;
  -moz-user-select: none !important;
  -ms-user-select: none !important;
  pointer-events: none !important;
  font-size: 0 !important;
  line-height: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
  background: transparent !important;
  color: transparent !important;
}

/* Удаляем псевдоэлементы номеров строк */
.highlight .lnt::before,
.highlight .lnt::after,
.highlight .lnl::before,
.highlight .lnl::after {
  display: none !important;
  content: "" !important;
}

/* =============================================================================
   SYNTAX HIGHLIGHTING - ИСПРАВЛЕННЫЕ ЦВЕТА
   ============================================================================= */

/* === СВЕТЛАЯ ТЕМА === */

/* Комментарии */
.highlight .c,
.highlight .c1,
.highlight .cm,
.highlight .cp {
  color: #6b7280 !important;
  font-style: italic !important;
}

/* Строки */
.highlight .s,
.highlight .s1,
.highlight .s2,
.highlight .se,
.highlight .sa {
  color: #059669 !important;
  font-weight: 500 !important;
}

/* Ключевые слова */
.highlight .k,
.highlight .kd,
.highlight .kn,
.highlight .kt,
.highlight .kc {
  color: #dc2626 !important;
  font-weight: 600 !important;
}

/* Функции и команды (ИСПРАВЛЕНО) */
.highlight .nf,
.highlight .fm,
.highlight .nb {
  color: #2563eb !important;
  font-weight: 600 !important;
}

/* Переменные */
.highlight .n,
.highlight .nv,
.highlight .nc {
  color: #ea580c !important;
}

/* Числа */
.highlight .m,
.highlight .mi,
.highlight .mf,
.highlight .mo {
  color: #7c3aed !important;
}

/* Операторы */
.highlight .o,
.highlight .ow {
  color: #1f2937 !important;
}

/* Символы */
.highlight .p {
  color: #374151 !important;
}

/* === ТЕМНАЯ ТЕМА === */

/* Комментарии - темная */
body.dark .highlight .c,
body.dark .highlight .c1,
body.dark .highlight .cm,
body.dark .highlight .cp {
  color: #7d8590 !important;
  font-style: italic !important;
}

/* Строки - темная */
body.dark .highlight .s,
body.dark .highlight .s1,
body.dark .highlight .s2,
body.dark .highlight .se,
body.dark .highlight .sa {
  color: #a5d6ff !important;
}

/* Ключевые слова - темная */
body.dark .highlight .k,
body.dark .highlight .kd,
body.dark .highlight .kn,
body.dark .highlight .kt,
body.dark .highlight .kc {
  color: #ff7b72 !important;
  font-weight: 600 !important;
}

/* Функции - темная (ИСПРАВЛЕНО) */
body.dark .highlight .nf,
body.dark .highlight .fm,
body.dark .highlight .nb {
  color: #d2a8ff !important;
  font-weight: 600 !important;
}

/* Переменные - темная */
body.dark .highlight .n,
body.dark .highlight .nv,
body.dark .highlight .nc {
  color: #ffa657 !important;
}

/* Числа - темная */
body.dark .highlight .m,
body.dark .highlight .mi,
body.dark .highlight .mf,
body.dark .highlight .mo {
  color: #79c0ff !important;
}

/* Операторы - темная */
body.dark .highlight .o,
body.dark .highlight .ow {
  color: #ff7b72 !important;
}

/* Символы - темная */
body.dark .highlight .p {
  color: #e6edf3 !important;
}

/* =============================================================================
   КНОПКА КОПИРОВАНИЯ
   ============================================================================= */

.copy-code {
  position: absolute !important;
  top: 0.75rem !important;
  right: 0.75rem !important;
  border-radius: 6px !important;
  padding: 0.375rem 0.625rem !important;
  font-size: 0.75rem !important;
  font-weight: 500 !important;
  cursor: pointer !important;
  z-index: 10 !important;
  transition: all 0.2s ease !important;
  font-family: system-ui, -apple-system, sans-serif !important;
  opacity: 0.8 !important;
  background: rgba(255, 255, 255, 0.9) !important;
  color: #374151 !important;
  border: 1px solid #d1d5db !important;
}

.copy-code:hover {
  opacity: 1 !important;
  transform: translateY(-1px) !important;
  background: #ffffff !important;
}

/* Кнопка копирования - темная тема */
body.dark .copy-code {
  background: rgba(33, 38, 45, 0.9) !important;
  color: #e6edf3 !important;
  border: 1px solid #30363d !important;
}

body.dark .copy-code:hover {
  background: #21262d !important;
}

/* =============================================================================
   АДАПТИВНОСТЬ
   ============================================================================= */

@media (max-width: 768px) {
  .highlight {
    margin: 1rem 0 !important;
    border-radius: 6px !important;
  }
  
  .highlight pre {
    font-size: 0.8rem !important;
    padding: 0.875rem 1rem !important;
  }
  
  .copy-code {
    top: 0.5rem !important;
    right: 0.5rem !important;
    padding: 0.25rem 0.5rem !important;
    font-size: 0.7rem !important;
  }
}
