<!-- =============================================================================
     –ß–ò–°–¢–´–ô EXTEND_HEAD.HTML - DevOps Way Blog
     ============================================================================= -->

<!-- –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
<meta name="robots" content="index, follow">
<link rel="canonical" href="{{ .Permalink }}">

<!-- =============================================================================
     –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ù–û–ú–ï–†–û–í –°–¢–†–û–ö
     ============================================================================= -->
<script>
(function() {
    function hideLineNumbers() {
        document.querySelectorAll('.lnt, .lnl').forEach(el => {
            el.style.display = 'none';
            el.style.userSelect = 'none';
        });
    }
    document.addEventListener('DOMContentLoaded', hideLineNumbers);
    setTimeout(hideLineNumbers, 100);
})();
</script>

<!-- =============================================================================
     MERMAID –î–ò–ê–ì–†–ê–ú–ú–´ (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)
     ============================================================================= -->
{{ $needsDiagrams := false }}
{{ if or .Params.diagrams 
          .Site.Params.enableDiagrams
          (findRE `{{<\s*mermaid` .RawContent)
          (findRE `class="mermaid"` .RawContent) }}
  {{ $needsDiagrams = true }}
{{ end }}

{{ if $needsDiagrams }}
<!-- CSS –¥–∏–∞–≥—Ä–∞–º–º -->
{{ with resources.Get "css/extended/diagrams.css" }}
  {{ $diagramCSS := . | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $diagramCSS.RelPermalink }}">
{{ end }}

<!-- Mermaid.js - –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –∑–∞–≥—Ä—É–∑–∫–∞ -->
<script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
  if (typeof mermaid !== 'undefined') {
    console.log('‚úÖ Mermaid –∑–∞–≥—Ä—É–∂–µ–Ω, –≤–µ—Ä—Å–∏—è:', mermaid.version);
    
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é —Ç–µ–º—É
    function getCurrentTheme() {
      return document.documentElement.getAttribute('data-theme') === 'dark' || 
             document.body.classList.contains('dark') ? 'dark' : 'base';
    }
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Mermaid
    mermaid.initialize({
      startOnLoad: false,
      theme: getCurrentTheme(),
      securityLevel: 'loose',
      fontFamily: 'Inter, sans-serif',
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true
      }
    });
    
    // –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–∏–∞–≥—Ä–∞–º–º
    function renderDiagrams() {
      document.querySelectorAll('.mermaid:not([data-processed])').forEach(function(element, index) {
        const text = element.textContent.trim();
        if (text) {
          const id = 'mermaid-' + Date.now() + '-' + index;
          
          mermaid.render(id, text).then(function(result) {
            console.log('‚úÖ –î–∏–∞–≥—Ä–∞–º–º–∞', index + 1, '–æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–∞');
            element.innerHTML = result.svg;
            element.setAttribute('data-processed', 'true');
            
            // –ë–∞–∑–æ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è SVG
            const svg = element.querySelector('svg');
            if (svg) {
              svg.style.maxWidth = '100%';
              svg.style.height = 'auto';
              svg.removeAttribute('height');
            }
          }).catch(function(error) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã', index + 1, ':', error);
            element.innerHTML = '<div style="padding: 1rem; color: #dc3545; border: 2px dashed #dc3545; border-radius: 8px;">‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã</div>';
            element.setAttribute('data-processed', 'error');
          });
        }
      });
    }
    
    // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
    renderDiagrams();
    
    // –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã –ë–ï–ó –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && 
            (mutation.attributeName === 'data-theme' || mutation.attributeName === 'class')) {
          
          console.log('üé® –°–º–µ–Ω–∞ —Ç–µ–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞');
          
          // –ù–ï –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Mermaid - –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω—è–µ–º CSS —Å—Ç–∏–ª–∏
          const newTheme = getCurrentTheme();
          console.log('üé® –ù–æ–≤–∞—è —Ç–µ–º–∞:', newTheme);
          
          // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–º—É —á–µ—Ä–µ–∑ CSS –∫–ª–∞—Å—Å—ã –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
          document.querySelectorAll('.mermaid[data-processed="true"]').forEach(function(element) {
            element.setAttribute('data-theme', newTheme);
          });
        }
      });
    });
    
    // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ —Ç–µ–º—ã
    observer.observe(document.documentElement, {
      attributes: true,
      attributeFilter: ['data-theme', 'class']
    });
    
    observer.observe(document.body, {
      attributes: true,
      attributeFilter: ['class']
    });
    
    // –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–ª–∞–¥–∫–∏
    window.debugMermaid = function() {
      console.log('=== –û–¢–õ–ê–î–ö–ê MERMAID ===');
      console.log('–î–æ—Å—Ç—É–ø–µ–Ω:', typeof mermaid !== 'undefined');
      console.log('–í–µ—Ä—Å–∏—è:', mermaid?.version || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ');
      console.log('–¢–µ–∫—É—â–∞—è —Ç–µ–º–∞:', getCurrentTheme());
      console.log('–î–∏–∞–≥—Ä–∞–º–º –≤—Å–µ–≥–æ:', document.querySelectorAll('.mermaid').length);
      console.log('–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:', document.querySelectorAll('.mermaid[data-processed="true"]').length);
      console.log('–° –æ—à–∏–±–∫–∞–º–∏:', document.querySelectorAll('.mermaid[data-processed="error"]').length);
    };
    
    // –ê–í–ê–†–ò–ô–ù–ê–Ø —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –¥–∏–∞–≥—Ä–∞–º–º
    window.resetMermaid = function() {
      console.log('üîÑ –ê–≤–∞—Ä–∏–π–Ω—ã–π —Å–±—Ä–æ—Å –≤—Å–µ—Ö –¥–∏–∞–≥—Ä–∞–º–º');
      
      // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
      document.querySelectorAll('.mermaid').forEach(function(element) {
        if (element.getAttribute('data-processed')) {
          element.removeAttribute('data-processed');
          element.removeAttribute('data-theme');
        }
      });
      
      // –ü–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å —Ç–µ–∫—É—â–µ–π —Ç–µ–º–æ–π
      mermaid.initialize({
        startOnLoad: false,
        theme: getCurrentTheme(),
        securityLevel: 'loose',
        fontFamily: 'Inter, sans-serif'
      });
      
      // –ó–∞–Ω–æ–≤–æ —Ä–µ–Ω–¥–µ—Ä–∏–º
      setTimeout(renderDiagrams, 100);
    };
    
  } else {
    console.error('‚ùå Mermaid –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
  }
});

console.log('üéØ Mermaid —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —Ç–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω');
console.log('–ö–æ–º–∞–Ω–¥—ã: debugMermaid(), resetMermaid()');
</script>

<!-- –°—Ç–∏–ª–∏ –¥–ª—è Mermaid -->
<style>
.mermaid {
    text-align: center;
    margin: 2rem 0;
    padding: 1rem;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: var(--code-bg);
}

.mermaid svg {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
}

@media (max-width: 768px) {
    .mermaid {
        font-size: 14px;
        margin: 1rem -1rem;
        border-radius: 0;
        border-left: none;
        border-right: none;
    }
}
</style>
{{ end }}

<!-- =============================================================================
     D3.js –î–ò–ê–ì–†–ê–ú–ú–´ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
     ============================================================================= -->
{{ if .Params.diagrams }}
<!-- D3.js –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js" 
        crossorigin="anonymous" 
        referrerpolicy="no-referrer"></script>

<!-- JavaScript –¥–∏–∞–≥—Ä–∞–º–º -->
{{ with resources.Get "js/diagram-system.js" }}
  {{ $diagramJS := . | minify | fingerprint }}
  <script defer src="{{ $diagramJS.RelPermalink }}"></script>
{{ end }}
{{ end }}

<!-- =============================================================================
     –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–´ (—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
     ============================================================================= -->
{{ if eq .Title "üéØ SFIA Calculator: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–∞ 2 –º–∏–Ω—É—Ç—ã" }}
<link rel="stylesheet" href="/css/sfia-calculator.css">
<script defer src="/js/sfia-calculator.js"></script>
{{ end }}

{{ if eq .Title "üìê T-Shape Assessment: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–≤–æ–π DevOps –ø—Ä–æ—Ñ–∏–ª—å –∑–∞ 5 –º–∏–Ω—É—Ç" }}
<link rel="stylesheet" href="/css/systems-thinking-calculator.css">
<script defer src="/js/systems-thinking-calculator.js"></script>
{{ end }}

<!-- =============================================================================
     –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨
     ============================================================================= -->
{{ if eq .Site.Params.env "production" }}
<link rel="dns-prefetch" href="//unpkg.com">
<link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
{{ end }}

<!-- =============================================================================
     FALLBACK –î–õ–Ø –°–¢–ê–†–´–• –ë–†–ê–£–ó–ï–†–û–í
     ============================================================================= -->
<script>
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ ES6
if (!window.Map || !window.Set || !Array.from) {
    console.warn('‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä');
}

// Fallback –¥–ª—è CSS Custom Properties
if (!window.CSS || !CSS.supports('color', 'var(--test)')) {
    document.documentElement.classList.add('no-css-variables');
}
</script>

<style>
/* Fallback —Å—Ç–∏–ª–∏ */
.no-css-variables {
    background-color: #ffffff;
    color: #1d1d1d;
}

.no-css-variables.dark {
    background-color: #1d1d1d;
    color: #ffffff;
}
</style>