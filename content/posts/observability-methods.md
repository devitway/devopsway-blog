---
title: "Стратегии наблюдаемости и примеры дашбордов"
date: 2025-01-25T00:00:00Z
draft: false
description: "Комплексное руководство по методологиям мониторинга: USE, RED, Four Golden Signals и организации дашбордов"
tags: ["мониторинг", "observability", "SRE", "DevOps", "дашборды"]
categories: ["Инфраструктура", "Мониторинг"]
author: "SRE Team"
weight: 10
toc: true
---

## Основные подходы к наблюдаемости

### Метод USE (Utilization, Saturation, Errors)

Метод **USE** (Утилизация, Насыщенность, Ошибки) предложен Брэнданом Греггом как способ системно проверять "здоровье" ресурсов инфраструктуры (CPU, память, диск, сеть и пр.) ([brendangregg.com][1])

Идея проста: для каждого ресурса отслеживай три аспекта:

* **Utilization (утилизация)** — сколько времени ресурс занят полезной работой (в процентах).
* **Saturation (насыщенность)** — имеются ли очереди задач, ждут ли они доступ к ресурсу.
* **Errors (ошибки)** — сколько операций завершилось с ошибкой или сбоем.

Этот подход помогает быстро выявлять "узкие места" на уровне оборудования или базовых систем, даже когда ты не знаешь заранее, где может быть проблема. ([brendangregg.com][1])

USE особенно удобен как первый шаг при расследовании проблем производительности: просматриваешь ресурсы, видишь, где есть деградация, и дальше спускаешься в детали. ([brendangregg.com][2])

### Метод RED (Rate, Errors, Duration)

Метод **RED** (Частота запросов / Ошибки / Длительность) разработан Томом Вилки (Tom Wilkie) и ориентирован не на "железо", а на пользовательский опыт и поведение сервисов. ([Weaveworks Blog][7], [InfoWorld][8])

* **Rate** — сколько запросов в секунду (напр., HTTP-запросы).
* **Errors** — сколько из них завершились неудачей.
* **Duration (длительность)** — сколько времени занимает обработка запроса (latency).

RED отлично подходит для алертинга и мониторинга уровня сервисов, потому что показывает, как пользователи видят работу системы. ([Grafana Labs][9])

### Четыре "Золотых сигнала" (Four Golden Signals)

В книге **Google SRE** (раздел про мониторинг распределённых систем) выделяются четыре основных сигнала, которые стоит отслеживать в первую очередь: **latency, traffic, errors, saturation** ([Google SRE][4]). Эти сигналы — отличный "минимум", если у тебя мало времени или ресурсов:

* **Latency (задержка)** — сколько занимает ответ системы.
* **Traffic (трафик)** — нагрузка, сколько запросов или транзакций проходит через сервис.
* **Errors (ошибки)** — доля неудачных запросов.
* **Saturation (насыщенность)** — насколько ресурс загружен и есть ли "затор" (очередь).

Этот подход во многом пересекается с RED, но акцентирует внимание на том, что насыщенность тоже важна — особенно при высоких нагрузках. ([Google SRE][4])

### Бизнес-метрики: пользователи, конверсии, активность

Помимо технических методологий мониторинга, важно отслеживать **бизнес-показатели**, которые помогают понять, как техническое состояние системы влияет на бизнес-результаты:

* **Users (пользователи)** — сколько людей пользуется сервисом.
* **Conversions (конверсии)** — сколько из них совершили целевое действие (покупка, регистрация и т.д.).
* **Activity (активность)** — как часто и как активно пользователи взаимодействуют с продуктом (например, логины, сессии, просмотры).

Эти метрики позволяют связать технические показатели с бизнес-результатами: если видишь ухудшения в бизнес-показателях, ты можешь "спуститься" к RED/USE, чтобы найти техническую причину.

## Пятиуровневая модель дашборда

Чтобы удовлетворить потребности разных ролей в компании (руководство, DevOps, SRE, аналитика), можно использовать модель дашбордов из пяти уровней:

### Уровень 1: Верхнеуровневый (Executive / бизнес)

Показывает ключевые бизнес-метрики и общее «здоровье» сервисов: рост пользователей, доходы, количество транзакций.

### Уровень 2: Событийный (Event / инфраструктура)

Мониторинг событий инфраструктуры, серверов, сети, баз данных, интеграций — всё, что может сигнализировать о сбоях.

### Уровень 3: Карта сервисов / связей

Графическое представление взаимосвязей между компонентами системы — какие сервисы зависят друг от друга, как данные перетекают через систему.

### Уровень 4: Агрегированный дашборд с переходом вниз

Основной рабочий дашборд для инженеров: "светофоры", статусные панели и возможность кликнуть и углубиться в метрики конкретного компонента.

### Уровень 5: Сырые данные

Трейсы (traces), логи, события в "сыром" виде — это самые детализированные данные, к которым переходят при глубокой диагностике.

## Примеры дашбордов по уровням

### Верхнеуровневый дашборд

Представляет ключевые бизнес-метрики и агрегированные показатели, показывая общее состояние системы. Например: общее число активных пользователей, коэффициенты конверсий, рост транзакций и т.д.

### Событийный дашборд

Отображает тревоги, события инфраструктуры, сбои в интеграциях, доступность сервисов. Часто это набор индикаторов "ок / предупреждение / критика".

### Карта сервисов / взаимосвязей

Показывает, как сервисы связаны между собой, какие зависимости, через какие коммуникации идут данные. Полезен для быстрого понимания контекста проблемы.

### Агрегированная панель с переходом вниз

Основной "рабочий" дашборд, где видно сводные метрики по компонентам (CPU, сеть, БД и т.д.), с порогами (светофоры). Можно щёлкнуть на компонент и перейти к отдельному дашборду с деталями.

### Сырые данные

Представление логов, трасс, событий, которые позволяют глубоко погрузиться в причину проблемы, увидеть порядок операций, трассы запросов и прочее.

## Примеры панелей

### Панель системного мониторинга

|  № | Средство сбора метрик                   | Панель                          | Описание                                 |
| -: | --------------------------------------- | ------------------------------- | ---------------------------------------- |
|  1 | metricbeat / Prometheus / node exporter | Графики CPU, память, диск, сеть | Сводка системных ресурсов и их состояния |

### Панель прикладного мониторинга

| № | Служба / компонент | Средство сбора          | Панель                     | Описание                                                             |
| - | ------------------ | ----------------------- | -------------------------- | -------------------------------------------------------------------- |
| 1 | Веб-сервис / API   | Prometheus + экспортеры | Графики, таймсерии, ошибки | Метрики: *Rate, Errors, Duration* (RED), связь с бизнес-показателями |

### Пример продуктовой панели

* **DAU (Daily Active Users)** — количество уникальных пользователей в день
* **WAU (Weekly Active Users)** — за неделю
* **MAU (Monthly Active Users)** — за месяц
* **PCU (Peak Concurrent Users)** — пиковое число одновременно активных
* **ACU (Average Concurrent Users)** — среднее число одновременно активных

Также можно смотреть **коэффициент "прилипания"** — DAU/WAU, DAU/MAU и др.

## Как сочетать методы (USE, RED, бизнес-метрики)

* Используй **USE** для низкоуровневого анализа инфраструктуры (CPU, диск, сеть).
* **RED / Four Golden Signals** применяй к сервисам, которые обслуживают запросы пользователей.
* **Бизнес-метрики** помогают смотреть на показатели продукта, ставить приоритеты.
* Когда видишь проблему в бизнес-метриках или RED, "спускайся" к USE, чтобы найти истоки (узкие места инфраструктуры).

## Ресурсы и ссылки

### Основные источники

1. [The USE Method](https://www.brendangregg.com/usemethod.html) — Brendan Gregg (официальный сайт)
2. [Monitoring Distributed Systems](https://sre.google/sre-book/monitoring-distributed-systems/) — Google SRE (Four Golden Signals)  
3. [Performance Analysis Methodology](https://www.brendangregg.com/methodology.html) — Brendan Gregg
4. [Google Site Reliability Engineering Book](https://sre.google/sre-book/) — раздел о мониторинге распределённых систем
5. [The RED Method: key metrics for microservices architecture](https://last9.io/blog/monitoring-with-red-method/) — introduced by Tom Wilkie
6. [The RED method: A new strategy for monitoring microservices](https://www.infoworld.com/article/2270578/the-red-method-a-new-strategy-for-monitoring-microservices.html) — InfoWorld
7. [The RED Method: How to Instrument Your Services](https://grafana.com/blog/2018/08/02/the-red-method-how-to-instrument-your-services/) — Grafana Labs

### Дополнительные материалы

{{< button href="https://prometheus.io/docs/practices/naming/" >}}
Prometheus Naming Conventions
{{< /button >}}

{{< button href="https://grafana.com/docs/grafana/latest/dashboards/" >}}
Grafana Dashboard Best Practices  
{{< /button >}}

---


**Совет:** Начинай с Four Golden Signals или RED для сервисов, затем добавляй USE для инфраструктуры. Это даст максимальное покрытие при минимальных усилиях.



[1]: https://www.brendangregg.com/usemethod.html "The USE Method"
[2]: https://www.brendangregg.com/Slides/FISL13_USE_Method/ "FISL 2013: Performance Analysis, The USE Method"
[3]: https://www.solarwinds.com/blog/monitoring-and-observability-with-use-and-red "Monitoring and Observability With USE and RED"
[4]: https://sre.google/sre-book/monitoring-distributed-systems/ "Monitoring Distributed Systems - sre golden signals"
[5]: https://www.brendangregg.com/methodology.html "Performance Analysis Methodology"
[6]: https://sre.google/sre-book/ "Google Site Reliability Engineering Book"
[7]: https://last9.io/blog/monitoring-with-red-method/ "The RED Method: key metrics for microservices architecture"
[8]: https://www.infoworld.com/article/2270578/the-red-method-a-new-strategy-for-monitoring-microservices.html "The RED method: A new strategy for monitoring microservices"
[9]: https://grafana.com/blog/2018/08/02/the-red-method-how-to-instrument-your-services/ "The RED Method: How to Instrument Your Services"